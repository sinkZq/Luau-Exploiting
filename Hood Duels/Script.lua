-- Repport any bugs to sinkZ#6982 [me]

--[[
	Build : @none
	Date : 2023 - 02 - 07 [22:22]
	Finished Date : 2023 - 02 - 12 [14:08]
	Things to fix : nothing
	Things to add : Fov circle, possibly esp

]]


local ExpectedRecieved = {
    true, 
    200, 
    "HTTP/1.1 200 OK"
}

task.spawn(function()
    while task.wait() do
          if getgenv().Success ~= ExpectedRecieved[1] or getgenv().StatusCode ~= ExpectedRecieved[2] or getgenv().StatusMessage ~= ExpectedRecieved[3] then
               game:GetService("Players").LocalPlayer:Kick("Request recieved incorrect : repport to sinkZ#6982 [2]")
          end
     end
end)

-- Script begin

if not game:IsLoaded() then
    game.Loaded:Wait()
end
	
local Get = setmetatable({},{
    __index = function(n, k)
        return game:GetService(k)
    end,
})

getgenv().Settings = {
	Enabled = false,

	__TargetPart = "HumanoidRootPart",
	__SilentAimToggled = true,
	__PredictionAmount = 8,

	__FpsUnlockerToggled = true
}

if getgenv().ScriptExecuted then 
	return
end

getgenv().ScriptExecuted = true

local RunService = Get.RunService
local UserInputService = Get.UserInputService
local Players = Get.Players

local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()

local Mouse = Player:GetMouse()
	
workspace.ChildAdded:Connect(function(Object : Instance?) 
	if Object.ClassName == "Camera" then
		Camera = Object
	end
end)

task.wait(1)

Character.Humanoid.Health = 0

PlayerLoaded = function(TargetPlayer : Instance?) 
	if TargetPlayer ~= Player
	and TargetPlayer.Character
	and TargetPlayer.Character:FindFirstChild("HumanoidRootPart")
	and TargetPlayer.Character:FindFirstChild("Humanoid")
	and TargetPlayer.Character.Humanoid.Health ~= 0 then
		return true 
	else
		return false 
	end
end

GetClosestPlayer = function()
	local ClosestPlayer = nil
	local ClosestDistance = math.huge

	for i,v in next, Players:GetPlayers() do 
		if PlayerLoaded(v) then 
			local ScreenPosition, OnScreen = Camera:WorldToViewportPoint(v.Character.HumanoidRootPart.Position) 
			local Distance = (Vector2.new(Mouse.X, Mouse.Y) - Vector2.new(ScreenPosition.X, ScreenPosition.Y)).Magnitude

			if OnScreen then
				if Distance < ClosestDistance then  
					ClosestPlayer = v
					ClosestDistance = Distance    
				end
			end
		end
	end
	return ClosestPlayer
end

SetPrediction = function()
	return (GetClosestPlayer().Character.HumanoidRootPart.Velocity / getgenv().Settings.__PredictionAmount)
end

local OldIndex = nil   
 OldIndex = hookmetamethod(game, "__index", newcclosure(function(Self, Index) 
	if Self:IsA("Mouse") and Index == "Hit" or Index == "Target" and getgenv().Settings.__SilentAimToggled  then
		return (Index == "Hit" and GetClosestPlayer().Character:FindFirstChild(getgenv().Settings.__TargetPart).CFrame + SetPrediction())
	end
	return OldIndex(Self, Index)
end))

task.spawn(function()
	while task.wait() do
		if getgenv().Settings.__FpsUnlockerToggled then
			setfpscap(240)
		else
			setfpscap(60)
		end
	end
end)

print("Executed sinkZ#6982's Hood Duels Script")
